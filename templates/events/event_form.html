{% extends "base.html" %}
{% load static %}

{% block title %}Crear evento | Eventos Vecinales{% endblock %}

{% block extra_head %}
<style>
    .ev-create-wrapper {
        display: flex;
        justify-content: center;
    }

    .ev-create-card {
        width: 100%;
        max-width: 880px;
        background: #ffffff;
        border-radius: 24px;
        padding: 28px 30px 24px;
        box-shadow:
            0 18px 45px rgba(15, 23, 42, 0.08),
            0 0 0 1px rgba(148, 163, 184, 0.35);
    }

    .ev-create-header {
        margin-bottom: 20px;
    }

    .ev-create-title {
        font-size: 22px;
        font-weight: 700;
        color: #111827;
        margin: 0 0 4px;
    }

    .ev-create-subtitle {
        font-size: 13px;
        color: #6b7280;
        margin: 0;
    }

    .ev-section {
        margin-top: 22px;
        padding-top: 18px;
        border-top: 1px solid #e5e7eb;
    }

    .ev-section:first-of-type {
        border-top: none;
        padding-top: 0;
        margin-top: 0;
    }

    .ev-section-title {
        font-size: 15px;
        font-weight: 600;
        color: #111827;
        margin-bottom: 6px;
    }

    .ev-section-helper {
        font-size: 12px;
        color: #6b7280;
        margin-bottom: 16px;
    }

    .ev-grid-2 {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 16px 20px;
    }

    .ev-grid-3 {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 16px 18px;
    }

    @media (max-width: 720px) {
        .ev-create-card {
            padding: 20px 16px 18px;
            border-radius: 18px;
        }
        .ev-grid-2,
        .ev-grid-3 {
            grid-template-columns: 1fr;
        }
    }

    .ev-field {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .ev-label-row {
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .ev-label {
        font-size: 13px;
        font-weight: 600;
        color: #111827;
    }

    .ev-label-optional {
        font-size: 11px;
        color: #9ca3af;
        font-weight: 400;
    }

    .ev-help {
        font-size: 11px;
        color: #9ca3af;
    }

    .ev-input,
    .ev-textarea,
    .ev-input-file {
        width: 100%;
        border-radius: 999px;
        border: 1px solid #d1d5db;
        padding: 9px 13px;
        font-size: 13px;
        outline: none;
        background: #f9fafb;
        transition: border-color 0.12s ease, background 0.12s ease, box-shadow 0.12s ease;
    }

    .ev-textarea {
        border-radius: 16px;
        resize: vertical;
        min-height: 96px;
        padding: 9px 11px;
    }

    .ev-input:focus,
    .ev-textarea:focus {
        border-color: #f59e0b;
        background: #ffffff;
        box-shadow: 0 0 0 1px rgba(245, 158, 11, 0.35);
    }

    .ev-input-file {
        border-radius: 999px;
        padding: 7px 10px;
        background: #f9fafb;
    }

    /* checkbox row genérico */
    .ev-checkbox-row {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        font-size: 12px;
        color: #4b5563;
    }

    .ev-checkbox-row input[type="checkbox"] {
        margin-top: 2px;
    }

    /* errores */
    .ev-error {
        font-size: 11px;
        color: #b91c1c;
        margin-top: 3px;
    }

    /* footer botones */
    .ev-create-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 16px;
        margin-top: 22px;
        padding-top: 16px;
        border-top: 1px solid #e5e7eb;
    }

    .ev-create-footer-left {
        font-size: 11px;
        color: #9ca3af;
    }

    .ev-btn-row {
        display: flex;
        gap: 10px;
    }

    .ev-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 999px;
        padding: 9px 18px;
        font-size: 13px;
        font-weight: 500;
        border: none;
        cursor: pointer;
        text-decoration: none;
        transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease, color 0.12s ease;
        white-space: nowrap;
    }

    .ev-btn-secondary {
        background: #ffffff;
        color: #111827;
        border: 1px solid #d1d5db;
    }

    .ev-btn-secondary:hover {
        background: #f3f4f6;
    }

    .ev-btn-primary {
        background: #fbbf24;
        color: #78350f;
        box-shadow: 0 10px 24px rgba(245, 158, 11, 0.55);
    }

    .ev-btn-primary:hover {
        background: #f59e0b;
        transform: translateY(-1px);
    }

    /* ---------- TOGGLE SOLO MAYORES DE 18 ---------- */

    .ev-section-restricciones-helper {
        font-size: 12px;
        color: #6b7280;
        margin-bottom: 12px;
    }

    .ev-toggle-row {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
    }

    .ev-toggle {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        user-select: none;
    }

    .ev-toggle-input {
        display: none;
    }

    .ev-toggle-slider {
        width: 42px;
        height: 24px;
        border-radius: 999px;
        background: #e5e7eb;
        position: relative;
        transition: background 0.15s ease;
    }

    .ev-toggle-slider::before {
        content: "";
        position: absolute;
        top: 3px;
        left: 3px;
        width: 18px;
        height: 18px;
        border-radius: 999px;
        background: #ffffff;
        box-shadow: 0 1px 4px rgba(15, 23, 42, 0.25);
        transition: transform 0.15s ease;
    }

    .ev-toggle-input:checked + .ev-toggle-slider {
        background: #f59e0b;
    }

    .ev-toggle-input:checked + .ev-toggle-slider::before {
        transform: translateX(18px);
    }

    .ev-toggle-label {
        font-size: 12px;
        color: #4b5563;
    }
</style>
{% endblock %}

{% block content %}
<div class="ev-create-wrapper">
    <div class="ev-create-card">

        <div class="ev-create-header">
            <h1 class="ev-create-title">Crear nuevo evento</h1>
            <p class="ev-create-subtitle">
                Completa la información de tu actividad para que los vecinos puedan encontrarla y participar.
            </p>
        </div>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.non_field_errors }}

            <!-- Información básica -->
            <section class="ev-section">
                <h2 class="ev-section-title">Información básica</h2>
                <p class="ev-section-helper">
                    Utiliza un título claro y una descripción breve que explique de qué trata el evento.
                </p>

                <div class="ev-grid-2">
                    <div class="ev-field">
                        <div class="ev-label-row">
                            <label class="ev-label" for="{{ form.titulo.id_for_label }}">Título del evento</label>
                        </div>
                        {{ form.titulo }}
                        {% for error in form.titulo.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                        <div class="ev-help">Máx. 200 caracteres.</div>
                    </div>

                    <div class="ev-field">
                        <div class="ev-label-row">
                            <span class="ev-label">Localidad / comuna</span>
                        </div>
                        {{ form.localidad }}
                        {% for error in form.localidad.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                        <div class="ev-help">Ejemplo: La Florida, Maipú, Puente Alto…</div>
                    </div>
                </div>

                <div class="ev-field" style="margin-top:14px;">
                    <div class="ev-label-row">
                        <label class="ev-label" for="{{ form.descripcion.id_for_label }}">Descripción del evento</label>
                        <span class="ev-label-optional">(Opcional)</span>
                    </div>
                    {{ form.descripcion }}
                    {% for error in form.descripcion.errors %}
                        <div class="ev-error">{{ error }}</div>
                    {% endfor %}
                    <div class="ev-help">
                        Incluye beneficios, actividades principales y a quién está dirigido.
                    </div>
                </div>
            </section>

            <!-- Lugar y fechas -->
            <section class="ev-section">
                <h2 class="ev-section-title">Fecha, horario y lugar</h2>
                <p class="ev-section-helper">
                    Define cuándo y dónde se realizará tu evento. Se usará para mostrar la tarjeta y el estado (próximo, pronto, pasado).
                </p>

                <div class="ev-grid-2">
                    <div class="ev-field">
                        <span class="ev-label">Fecha de inicio</span>
                        {{ form.fecha_inicio }}
                        {% for error in form.fecha_inicio.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="ev-field">
                        <span class="ev-label">Fecha de término</span>
                        {{ form.fecha_termino }}
                        {% for error in form.fecha_termino.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="ev-grid-2" style="margin-top:14px;">
                    <div class="ev-field">
                        <span class="ev-label">Hora de inicio</span>
                        {{ form.hora_inicio }}
                        {% for error in form.hora_inicio.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="ev-field">
                        <span class="ev-label">Hora de término</span>
                        {{ form.hora_termino }}
                        {% for error in form.hora_termino.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="ev-grid-2" style="margin-top:14px;">
                    <div class="ev-field">
                        <span class="ev-label">Lugar</span>
                        {{ form.lugar }}
                        {% for error in form.lugar.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="ev-field">
                        <span class="ev-label">Dirección</span>
                        {{ form.direccion }}
                        {% for error in form.direccion.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                        <div class="ev-help">Calle, número y referencias para llegar.</div>
                    </div>
                </div>
            </section>

            <!-- Imagen y cupos -->
            <section class="ev-section">
                <h2 class="ev-section-title">Imagen y cupos</h2>
                <p class="ev-section-helper">
                    Una buena imagen ayuda a que tu evento destaque. Define también el valor de la entrada y los cupos disponibles.
                </p>

                <div class="ev-grid-2">
                    <div class="ev-field">
                        <div class="ev-label-row">
                            <span class="ev-label">Imagen del evento</span>
                            <span class="ev-label-optional">(Opcional)</span>
                        </div>
                        {{ form.imagen }}
                        {% for error in form.imagen.errors %}
                            <div class="ev-error">{{ error }}</div>
                        {% endfor %}
                        <div class="ev-help">
                            Tamaño sugerido: 800×800 • Máx: 4&nbsp;MB • Formato: JPG o PNG.
                        </div>
                    </div>

                    <div class="ev-field">
                        <div class="ev-field">
                            <span class="ev-label">Valor entrada (CLP)</span>
                            {{ form.precio_entrada }}
                            {% for error in form.precio_entrada.errors %}
                                <div class="ev-error">{{ error }}</div>
                            {% endfor %}
                            <div class="ev-help">
                                Ingresa el precio por persona en pesos chilenos. Usa <strong>0</strong> si el evento es gratuito.
                            </div>
                        </div>

                        <div class="ev-field" style="margin-top:10px;">
                            <span class="ev-label">Cupos totales</span>
                            {{ form.cupos_totales }}
                            {% for error in form.cupos_totales.errors %}
                                <div class="ev-error">{{ error }}</div>
                            {% endfor %}
                            <div class="ev-help">
                                Si lo dejas en <strong>0</strong>, el evento no tendrá límite de cupos.
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Restricciones / términos con TOGGLE +18 -->
            <section class="ev-section">
                <h2 class="ev-section-title">Restricciones y confirmación</h2>
                <p class="ev-section-restricciones-helper">
                    Define si este evento es exclusivo para personas mayores de 18 años.
                </p>

                <div class="ev-field" style="gap:10px;">

                    <div class="ev-toggle-row">
                        <label class="ev-toggle" for="id_solo_mayores_18">
                            <input
                                type="checkbox"
                                name="{{ form.solo_mayores_18.name }}"
                                id="id_solo_mayores_18"
                                class="ev-toggle-input"
                                {% if form.solo_mayores_18.value %}checked{% endif %}
                            >
                            <span class="ev-toggle-slider"></span>
                            <span class="ev-toggle-label">Evento solo para personas mayores de 18 años</span>
                        </label>
                    </div>

                    {% for error in form.solo_mayores_18.errors %}
                        <div class="ev-error">{{ error }}</div>
                    {% endfor %}

                    <p class="ev-section-restricciones-helper">
                        Las cuentas con menos de 18 años no podrán comprar entradas a este evento.
                    </p>

                    <label class="ev-checkbox-row">
                        <input type="checkbox" name="acepta_terminos" required>
                        <span>
                            Acepto los <strong>términos y condiciones</strong> de la plataforma y confirmo que la información
                            ingresada es correcta.
                        </span>
                    </label>
                </div>
            </section>

            <!-- Footer -->
            <div class="ev-create-footer">
                <div class="ev-create-footer-left">
                    Puedes editar los detalles del evento más adelante si es necesario.
                </div>

                <div class="ev-btn-row">
                    <a href="{% url 'events:listar' %}" class="ev-btn ev-btn-secondary">Anterior</a>
                    <button type="submit" class="ev-btn ev-btn-primary">
                        Crear evento
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}
